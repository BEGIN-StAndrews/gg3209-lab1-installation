name: Lab 1 Validation

on: [push]

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ Checkout repository
      uses: actions/checkout@v2

    - name: ğŸ Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'

    - name: ğŸ“¦ Install Python dependencies
      run: |
        pip install jupyter nbconvert pandas numpy matplotlib geopandas folium nbformat

    - name: ğŸ“ Check required files (basic validation)
      run: |
        echo "ğŸ” Checking for required files..."
        test -f my_first_notebook.ipynb || { echo "âŒ Notebook missing"; exit 1; }
        test -f my_first_notebook.pdf || { echo "âŒ PDF missing"; exit 1; }
        test -f screenshot_1_installation_check.png || { echo "âŒ screenshot_1_installation_check.png missing"; exit 1; }
        test -f screenshot_2_jupyter_home.png || { echo "âŒ screenshot_2_jupyter_home.png missing"; exit 1; }
        test -f screenshot_3_notebook_complete.png || { echo "âŒ screenshot_3_notebook_complete.png missing"; exit 1; }
        echo "âœ… All required files are present"

    - name: âš™ï¸ Test notebook execution (quick check)
      run: |
        echo "ğŸš€ Executing notebook to ensure it runs..."
        jupyter nbconvert --to notebook --execute my_first_notebook.ipynb --output executed_notebook.ipynb
        echo "âœ… Notebook ran successfully"

    - name: ğŸ” Check anti-AI verification elements
      run: |
        echo "ğŸ›¡ï¸ Verifying presence of student ID elements..."
        grep -q "datetime.datetime.now()" my_first_notebook.ipynb || { echo "âŒ Timestamp code missing"; exit 1; }
        grep -q "platform.node()" my_first_notebook.ipynb || { echo "âŒ Computer name code missing"; exit 1; }
        echo "âœ… Verification elements are present"

    - name: ğŸ§ª Run point-based autograder (optional but useful)
      run: |
        echo "ğŸ“Š Running test.py for score breakdown..."
        python test_assignment.py || echo "âš ï¸ Autograder ran with issues (check output)."

    - name: âœ… All checks passed
      run: echo "ğŸ‰ Lab 1-Installation validation passed!"
